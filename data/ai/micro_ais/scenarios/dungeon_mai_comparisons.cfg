#textdomain wesnoth-ai

#define BOSS_UNIT SIDE X Y BOSS_ID BOSS_NAME
    [unit]
        side={SIDE}
        x,y={X},{Y}
        type="Death Knight"
        {IS_HERO}
        id={BOSS_ID}
        name={BOSS_NAME}
        # make boss invincible
        [status]
            invulnerable=yes
        [/status]
        placement="map"
        passable=yes
    [/unit]
#enddef

[test]
    id="dungeon_bosses"
    name= _ "Dungeon Bosses"

    victory_when_enemies_defeated=no

    {DEEP_UNDERGROUND}
    {DEFAULT_MUSIC_PLAYLIST}

    map_file=ai/micro_ais/maps/dungeon_mai_comparisons.map
    turns=-1

    [label]
        color="164,162,221"
        immutable=yes
        side=0
        text= _ "Zone Guardian MAI Chamber"
       
        visible_in_fog=yes
        visible_in_shroud=no
        x=21
        y=25
    [/label]
    [label]
        color="150,152,221"
        immutable=yes
        side=0
        text= _ "Boss MAI Chamber"
       
        visible_in_fog=yes
        visible_in_shroud=no
        x=23
        y=17
    [/label]
    [label]
        color="164,161,221"
        immutable=yes
        side=0
        text= _ "Hunter MAI Chamber"
       
        visible_in_fog=yes
        visible_in_shroud=no
        x=25
        y=20
    [/label]
    [label]
        color="100,221,221"
        immutable=yes
        side=0
        text= _ "Adventurer Camp"
        visible_in_fog=yes
        visible_in_shroud=no
        x=26
        y=30
    [/label]

    [side]
        controller="ai"
        fog=yes
        gold=0
        hidden=yes
        income=-2
        no_leader=yes
        share_vision="none"
        shroud=yes
        side=1
        team_name="team_zone_guardian_boss"
        user_team_name= _ "Zone Guardian Boss"
    [/side]
    [side]
        controller="ai"
        fog=yes
        gold=0
        hidden=yes
        income=-2
        no_leader=yes
        share_vision="none"
        shroud=yes
        side=2
        team_name="team_hunter_mai_boss"
        user_team_name= _ "Hunter MAI Boss"
    [/side]
    [side]
        controller="ai"
        fog=yes
        gold=0
        hidden=yes
        income=-2
        no_leader=yes
        share_vision="none"
        shroud=yes
        side=3
        team_name="team_boss_mai"
        user_team_name= _ "Boss MAI"
    [/side]
    [side]
        controller="human"
        fog=no
        gold=500
        hidden=no
        income=18
        no_leader=no
        share_vision="all"
        shroud=no
        side=4
        team_name="tester"
        user_team_name= _ "Adventurers"
        {FLAG_VARIANT6 ragged}
        recruit="Footpad, Thug, Poacher, Thief"
        [leader]
            id="Foolish_Hero"
            name= _ "Foolish Hero"
            type="Outlaw"
            placement=leader
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_QUICK}
            [/modifications]
        [/leader]
    [/side]

    [side]  # This side is only here because we need one persistent side for the game to go on
        side=5
        controller=null
        persistent=yes
        save_id=Grnk
        hidden=yes
    [/side]

    [event]
        name=prestart

        {BOSS_UNIT 3 18 9 Boss_MAI_unit ( _ "Erlornas the Forsaken")}
        {BOSS_UNIT 1 11 25 Zone_Guard_unit ( _ "Landar the Misled")}
        {BOSS_UNIT 2 35 20 Hunter_MAI_unit ( _ "Kalenz the Lonely")}

        {VARIABLE scenario_name boss_mai_comparisons}

        # define the micro AI
        [micro_ai]
            side=3
            ai_type=boss
            action=add

            id=Boss_MAI_unit
            [filter_location]
                x=18
                y=9
                radius=5
            [/filter_location]
        [/micro_ai]

        [micro_ai]
            side=2
            ai_type=hunter
            action=add

            id=Hunter_MAI_unit
            [filter_location]
                x=35
                y=20
                radius=5
            [/filter_location]
            home_x,home_y=35,20
            rest_turns=2

            show_messages=no
        [/micro_ai]

        [micro_ai]
            side=1
            ai_type=zone_guardian
            action=add

            id=Zone_Guard_unit
            [filter_location]
                x=11
                y=25
                radius=5
            [/filter_location]
        [/micro_ai]

        [objectives]
            summary= _ "Probe and Observe the Elite Class units"
            [objective]
                description= _ "Survive"
                condition=win
            [/objective]
            [objective]
                description= _ "Do something foolish"
                condition=win
            [/objective]
            [note]
                description= _ "All bosses are invincible."
            [/note]
        [/objectives]

        # The right-click menu items
        [set_menu_item]
            id=m01_end_scenario_boss_mai
            description= _ "End Scenario"
            image=items/ring-red.png~CROP(26,26,20,20)
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals boss_mai_comparisons}
            [/show_if]
            [command]
                [message]
                    speaker=narrator
                    image=wesnoth-icon.png
                    message= _ "Well, that was that."
                [/message]

                # So that game goes on to next scenario
                [modify_side]
                    side=5
                    controller=human
                [/modify_side]

                [endlevel]
                    result=victory
                    bonus=no
                    carryover_percentage=0
                    carryover_report=no
                    linger_mode=no
                [/endlevel]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=m02_new_unit_ruffian
            description= _ "Place Side 4 Ruffian"
            image=units/human-outlaws/ruffian.png~CROP(23,18,24,24)
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals boss_mai_comparisons}
            [/show_if]
            [command]
                {GENERIC_UNIT 4 Ruffian $x1 $y1}
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=m03_new_unit_footpad
            description= _ "Place Side 4 Footpad"
            image=units/human-outlaws/footpad.png~CROP(23,18,24,24)
            [show_if]
                {VARIABLE_CONDITIONAL scenario_name equals boss_mai_comparisons}
            [/show_if]
            [command]
                {GENERIC_UNIT 4 Footpad $x1 $y1}
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=start

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "Hello, and welcome to the Dungeon where the boss micro AI can be probed and investigated."
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "The boss micro AI has been assigned to a boss-class unit along with 2 other identical units which have the Zone Guardian Micro AI and the Hunter MAI respectively. This was done so as to investigate any behavioural changes and similaries can be observed."
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "The Boss Micro AI will initially wander around in its arena. However, if an enemy unit is within its zone, it will approach and target the unit. On kill, the boss unit will check for any nearby targets. If any are found, it will attack those. If not, it will return to wandering around in its zone. If an enemy unit decides to run away, the boss unit will pursue and will not stop until the enemy has been dealt with."
        [/message]
    [/event]

#undef BOSS_UNIT
[/test]
